Facts, Feeling, Findings  
사실(객관), 느낌(주관), 배운점  
칭찬과 반성

> ### TODAY :: 2021-01-02

* 공부한 내용
    * JPA 강의 듣기
      - 주요 내용 정리
        - 연관관계 매핑시 고려사항 3가지
          - 다중성
          - 단방향, 양방향
            - 테이블은 외래 키 하나로 양쪽을 조인할 수 있다. 방향이라는 개념이 없다.
            - 객체는 참조용 필드가 있는 쪽으로만 참조가 가능하다.
          - 연관관계의 주인
            - 객체 양방향 관계는 참조가 두군데이기 때문에 외래키를 관리할 곳을 지정해야 한다.
            - 주인: 외래키를 관리하는 참조
            - 주인의 반대편: 외래키에 영향을 주지 않음. 단순 조회만 가능하다.
        - 다대일
          - 다 쪽이 연관관계의 주인이 된다.
          - 가장 많이 사용한다.
        - 일대다
          - 일 쪽이 연관관계의 주인이 된다.
          - 하지만 테이블 일대다 관계는 항상 다쪽에 외래키가 존재한다.
          - 객체와 테이블의 차이 때문에 반대편 테이블의 외래키를 관리하는 특이한 구조
          - insert 후 update를 통해 외래키 설정을 완료하게 된다.
          - A 클래스(테이블)만 손을 댔는데 B 클래스 업데이트문이 발생하기 때문에 사용을 권장하지 않는다. 객체지향적으로 손해를 조금 보더라도 다대일 양방향으로 사용하는 것을 고려.
          - @JoinColumn을 꼭 사용해야 한다. 사용하지 않으면 조인 테이블 방식을 사용.
        - 일대일
          - 일대일은 반대도 일대일
          - 주 테이블이나 대상 테이블 중에 외래키 선택 가능
          - 외래키에 데이터베이스 유니크 제약조건 추가
          - 대상 테이블에 외래키 단방향은 JPA에서 지원하지 않는다. 양방향은 지원
          - 정리
              - 주 테이블에 외래키
                  - 장점: 주테이블만 조회해도 대상테이블 데이터 있는지 확인 가능
                  - 단점: 값이 없으면 외래키에 null 허용
              - 대상 테이블에 외래키
                  - 장점: 일대다 관계로 변경시 테이블 구조 유지
                  - 단점: 프록시 기능 한계로 항상 즉시로딩
        - 다대다
          - **실무에서 사용하면 안된다.** 실무에선 연결테이블이 단순히 연결만 하고 끝나지 않는다. 주문시간, 수량같은 데이터가 들어올 수 있다.
          - 관계형 데이터베이스는 정규화된 테이블 2개로 다대다 관계를 표현할 수 없음
          - 연결 테이블을 추가해서 일대다, 다대일 관계로 풀어내야 한다.
            - Member - Member_Product - Product
          - 객체는 컬렉션을 사용해서 객체 2개로 다대다 관계가 가능하다.
          - @ManyToMany, @JoinTable로 연결 테이블 지정
          - 단방향, 양방향 가능하다.
          - 다대다 한계 극복
              - 연결테이블용 엔티티 추가(테이블을 엔티티로 승격)
              - 일대다, 다대일로 관계를 표현한다.
          - PK를 별도의 값을 사용해야 유연성이 생긴다.
        - 자기 자신과 다대일 관계 맺기
          ```java
          @Entity
          public class Category {
            @ManyToOne
            @JoinColumn(name="parent_id")
            private Category parent;

            @OneToMany(mappedBy="parent")
            private List<Category> child = new ArrayList<>();
          }
          ```
